<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Vue.js with Bootstrap App</title>
    <!-- Bootstrap 5.3 CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN"
      crossorigin="anonymous"
    />
    <!-- Bootstrap Icons (optional) -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css"
    />

    <!-- Custom CSS -->
    <style>
      .cal-day {
        border: 1px solid #dee2e6;
        border-radius: 0.375rem;
        transition: background-color 0.15s ease-in-out;
      }

      .cal-day:hover {
        background-color: #f8f9fa;
      }

      .cal-day-item {
        font-size: 0.75rem;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }

      .logo {
        width: 50px;
        height: 50px;
        background-size: cover;
        background-position: center;
        border-radius: 0.25rem;
      }

      .month-name {
        font-size: 0.8rem;
      }

      .modal.show {
        display: block !important;
      }

      .modal-backdrop.show {
        opacity: 0.5;
      }

      /* Custom 14-column grid for calendar layout */
      .row-14 {
        display: flex;
        flex-wrap: wrap;
        margin-right: -15px;
        margin-left: -15px;
      }

      .col-14-1 {
        flex: 0 0 7.14285714%;
        max-width: 7.14285714%;
      }
      .col-14-2 {
        flex: 0 0 14.28571429%;
        max-width: 14.28571429%;
      }
      .col-14-3 {
        flex: 0 0 21.42857143%;
        max-width: 21.42857143%;
      }
      .col-14-4 {
        flex: 0 0 28.57142857%;
        max-width: 28.57142857%;
      }
      .col-14-5 {
        flex: 0 0 35.71428571%;
        max-width: 35.71428571%;
      }
      .col-14-6 {
        flex: 0 0 42.85714286%;
        max-width: 42.85714286%;
      }
      .col-14-7 {
        flex: 0 0 50%;
        max-width: 50%;
      }
      .col-14-8 {
        flex: 0 0 57.14285714%;
        max-width: 57.14285714%;
      }
      .col-14-9 {
        flex: 0 0 64.28571429%;
        max-width: 64.28571429%;
      }
      .col-14-10 {
        flex: 0 0 71.42857143%;
        max-width: 71.42857143%;
      }
      .col-14-11 {
        flex: 0 0 78.57142857%;
        max-width: 78.57142857%;
      }
      .col-14-12 {
        flex: 0 0 85.71428571%;
        max-width: 85.71428571%;
      }
      .col-14-13 {
        flex: 0 0 92.85714286%;
        max-width: 92.85714286%;
      }
      .col-14-14 {
        flex: 0 0 100%;
        max-width: 100%;
      }

      /* Column padding for 14-column system */
      [class*="col-14-"] {
        position: relative;
        width: 100%;
        padding-right: 15px;
        padding-left: 15px;
      }

      /* Calendar specific styles */
      .calendar-week {
        display: flex;
        flex-wrap: wrap;
        margin-bottom: 10px;
      }

      .calendar-day {
        flex: 0 0 14.28571429%; /* 2 columns out of 14 = 14.28% */
        max-width: 14.28571429%;
        padding: 5px;
        box-sizing: border-box;
      }

      .calendar-day-content {
        border: 1px solid #dee2e6;
        border-radius: 0.375rem;
        padding: 8px;
        min-height: 80px;
        background-color: #fff;
        transition: background-color 0.15s ease-in-out;
        cursor: pointer;
      }

      .calendar-day-content:hover {
        background-color: #f8f9fa;
      }

      /* Responsive adjustments */
      @media (max-width: 768px) {
        .calendar-day {
          flex: 0 0 50%; /* 2 days per row on mobile */
          max-width: 50%;
        }
      }

      @media (max-width: 480px) {
        .calendar-day {
          flex: 0 0 100%; /* 1 day per row on very small screens */
          max-width: 100%;
        }
      }
    </style>
  </head>
  <body>
    <div id="app">
      <!-- Navigation -->
      <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
        <div class="container">
          <a class="navbar-brand" href="#">{{ appName }}</a>
          <button
            class="navbar-toggler"
            type="button"
            data-bs-toggle="collapse"
            data-bs-target="#navbarNav"
            aria-controls="navbarNav"
            aria-expanded="false"
            aria-label="Toggle navigation"
          >
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav ms-auto">
              <li class="nav-item">
                <a class="nav-link active" href="#">Home</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="#">About</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="#">Contact</a>
              </li>
            </ul>
          </div>
        </div>
      </nav>

      <!-- Main Content -->
      <div class="container mt-4">
        <div class="row">
          <div class="col-12">
            <!-- Content div - converted from Angular template -->
            <div id="content">
              <!-- Header with logo -->
              <div class="d-flex align-items-center mb-4">
                <div
                  class="logo me-3"
                  style="
                    background: url('assets/img/remember2.png');
                    width: 50px;
                    height: 50px;
                    background-size: cover;
                  "
                ></div>
                <div class="logo-text h3 mb-0">When Did I Last?</div>
              </div>

              <!-- Inner content -->
              <div class="inner-content">
                <!-- Action buttons row -->
                <div class="row justify-content-between mb-3">
                  <div class="col-auto">
                    <button class="btn btn-primary" @click="backThreeMonths">
                      Back
                    </button>
                  </div>
                  <div class="col-auto">
                    <button class="btn btn-danger" @click="addItemUsed('')">
                      Add Item
                    </button>
                  </div>
                  <div class="col-auto">
                    <button
                      v-if="!showSearch"
                      class="btn btn-secondary"
                      @click="toggleSearch"
                    >
                      Search
                    </button>
                    <button v-else class="btn btn-danger" @click="toggleSearch">
                      Back
                    </button>
                  </div>
                  <div class="col-auto">
                    <button
                      class="btn btn-outline-secondary"
                      @click="loadItemsUsed"
                    >
                      Today
                    </button>
                  </div>
                </div>

                <!-- Modal for Add Item -->
                <div
                  class="modal fade"
                  :class="{ show: isVisible, 'd-block': isVisible }"
                  tabindex="-1"
                  v-if="isVisible"
                >
                  <div class="modal-dialog">
                    <div class="modal-content">
                      <div class="modal-header">
                        <h5 class="modal-title">Add Item Used</h5>
                        <button
                          type="button"
                          class="btn-close"
                          @click="handleCancel"
                        ></button>
                      </div>
                      <div class="modal-body">
                        <div class="row">
                          <div class="col-6">
                            <select class="form-select" v-model="selectedItem">
                              <option value="">Select Item</option>
                              <option
                                v-for="item in itemsList"
                                :key="item.id"
                                :value="item.id"
                              >
                                {{ item.title }}
                              </option>
                            </select>
                          </div>
                          <div class="col-6">
                            <input
                              type="date"
                              class="form-control"
                              v-model="dateUsed"
                              @change="onDateChanged"
                            />
                          </div>
                        </div>
                      </div>
                      <div class="modal-footer">
                        <button
                          type="button"
                          class="btn btn-secondary"
                          @click="handleCancel"
                        >
                          Cancel
                        </button>
                        <button
                          type="button"
                          class="btn btn-primary"
                          @click="handleOk"
                        >
                          OK
                        </button>
                      </div>
                    </div>
                  </div>
                </div>
                <div
                  class="modal-backdrop fade"
                  :class="{ show: isVisible }"
                  v-if="isVisible"
                ></div>

                <!-- Calendar view -->
                <div v-if="!showSearch">
                  <!-- Calendar container -->
                  <div class="calendar-container">
                    <!-- Week headers -->
                    <div class="calendar-week mb-2">
                      <div class="calendar-day">
                        <div class="text-center fw-bold text-muted small">
                          SUN
                        </div>
                      </div>
                      <div class="calendar-day">
                        <div class="text-center fw-bold text-muted small">
                          MON
                        </div>
                      </div>
                      <div class="calendar-day">
                        <div class="text-center fw-bold text-muted small">
                          TUE
                        </div>
                      </div>
                      <div class="calendar-day">
                        <div class="text-center fw-bold text-muted small">
                          WED
                        </div>
                      </div>
                      <div class="calendar-day">
                        <div class="text-center fw-bold text-muted small">
                          THU
                        </div>
                      </div>
                      <div class="calendar-day">
                        <div class="text-center fw-bold text-muted small">
                          FRI
                        </div>
                      </div>
                      <div class="calendar-day">
                        <div class="text-center fw-bold text-muted small">
                          SAT
                        </div>
                      </div>
                    </div>

                    <!-- Calendar weeks -->
                    <div
                      v-for="(week, i) in billsDays"
                      :key="i"
                      class="calendar-week"
                    >
                      <div
                        v-for="day in week.days"
                        :key="day.Date"
                        class="calendar-day"
                      >
                        <div
                          class="calendar-day-content"
                          @click="dayClicked(day.Date)"
                        >
                          <div class="mb-1">
                            <span
                              v-if="day.Month"
                              class="month-name text-muted small"
                              >{{ day.Month }} -
                            </span>
                            <span class="fw-bold">{{ day.Day }}</span>
                          </div>
                          <div
                            v-for="expense in expenses"
                            :key="expense.id"
                            class="mt-1"
                          >
                            <span
                              class="badge cal-day-item d-block mb-1"
                              :style="{ backgroundColor: expense.color }"
                              @click.stop="removeItemUsed(expense.id, $event)"
                              style="cursor: pointer"
                            >
                              {{ expense.item_name }}
                            </span>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div id="top"></div>
                </div>

                <!-- Search view -->
                <div v-else>
                  <div class="mb-3">
                    <input
                      type="text"
                      class="form-control"
                      placeholder="Search"
                      v-model="keyword"
                      @input="beginSearchItemsUsed"
                    />
                  </div>

                  <div v-if="searchItemsUsedList?.length">
                    <h3 class="mb-3 mt-3">Search Results</h3>
                    <div
                      v-for="dates in searchItemsUsedList"
                      :key="dates.date"
                      class="mb-4"
                    >
                      <div class="card">
                        <div class="card-header">
                          <span class="fw-bold fs-5">{{ dates.date }}</span>
                        </div>
                        <div class="list-group list-group-flush">
                          <div
                            v-for="item in dates.children"
                            :key="item.id"
                            class="list-group-item"
                          >
                            {{ item.item_name }}
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Footer -->
      <footer class="bg-light mt-5 py-4">
        <div class="container">
          <div class="row">
            <div class="col-12 text-center">
              <p class="mb-0">
                &copy; {{ currentYear }} {{ appName }}. All rights reserved.
              </p>
            </div>
          </div>
        </div>
      </footer>
    </div>

    <!-- Bootstrap 5.3 JavaScript Bundle -->
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
      crossorigin="anonymous"
    ></script>

    <!-- Vue.js 3 CDN -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>

    <!-- Your Vue App -->
    <script>
      const { createApp } = Vue;

      createApp({
        data() {
          return {
            appName: "When Did I Last?",
            currentYear: new Date().getFullYear(),
            // Modal state
            isVisible: false,
            selectedItem: "",
            dateUsed: "",
            dateFormat: "YYYY-MM-DD",
            // Search state
            showSearch: false,
            keyword: "",
            // Data arrays (will be populated with actual data later)
            itemsList: [
              { id: 1, title: "Example Item 1" },
              { id: 2, title: "Example Item 2" },
              { id: 3, title: "Example Item 3" },
            ],
            billsDays: [
              {
                days: [
                  {
                    Date: "2024-01-01",
                    Day: "1",
                    Month: "Jan",
                    showAsDay: true,
                  },
                  {
                    Date: "2024-01-02",
                    Day: "2",
                    Month: null,
                    showAsDay: true,
                  },
                  {
                    Date: "2024-01-03",
                    Day: "3",
                    Month: null,
                    showAsDay: true,
                  },
                  {
                    Date: "2024-01-04",
                    Day: "4",
                    Month: null,
                    showAsDay: true,
                  },
                  {
                    Date: "2024-01-05",
                    Day: "5",
                    Month: null,
                    showAsDay: true,
                  },
                  {
                    Date: "2024-01-06",
                    Day: "6",
                    Month: null,
                    showAsDay: true,
                  },
                  {
                    Date: "2024-01-07",
                    Day: "7",
                    Month: null,
                    showAsDay: true,
                  },
                ],
              },
            ],
            expenses: [{ id: 1, item_name: "Sample Item", color: "#1890ff" }],
            searchItemsUsedList: [
              {
                date: "2024-01-01",
                children: [{ id: 1, item_name: "Example Search Result" }],
              },
            ],
          };
        },
        methods: {
          // Modal methods
          addItemUsed(item) {
            this.isVisible = true;
            this.selectedItem = "";
            this.dateUsed = new Date().toISOString().split("T")[0];
          },
          handleOk() {
            // Add logic to save the item
            console.log("Save item:", this.selectedItem, this.dateUsed);
            this.isVisible = false;
          },
          handleCancel() {
            this.isVisible = false;
            this.selectedItem = "";
            this.dateUsed = "";
          },
          onDateChanged(event) {
            console.log("Date changed:", event.target.value);
          },
          // Navigation methods
          backThreeMonths() {
            console.log("Going back three months");
          },
          toggleSearch() {
            this.showSearch = !this.showSearch;
          },
          loadItemsUsed() {
            console.log("Loading items for today");
          },
          // Calendar methods
          dayClicked(date) {
            console.log("Day clicked:", date);
          },
          removeItemUsed(id, event) {
            event.stopPropagation();
            console.log("Remove item:", id);
          },
          // Search methods
          beginSearchItemsUsed() {
            console.log("Searching for:", this.keyword);
            // Add search logic here
          },
        },
        mounted() {
          console.log("Vue app mounted successfully!");
        },
      }).mount("#app");
    </script>
  </body>
</html>
